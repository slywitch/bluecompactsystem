/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * CadastroAgenda.java
 *
 * Created on 28/12/2009, 19:59:12
 */

package telas;

import classes.Combo;
import classes.ConexaoPostgresql;
import classes.TextDocument;
import classes.Funcoes;
import java.awt.Dimension;
import java.awt.event.KeyEvent;
import java.sql.ResultSet;
import java.text.SimpleDateFormat;
//import java.util.Date;
import javax.swing.ComboBoxModel;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JDesktopPane;
import javax.swing.JOptionPane;

/**
 *
 * @author Jeff
 */
public class CadastroAgenda extends javax.swing.JInternalFrame {

    private ConexaoPostgresql Conexao;
    private Funcoes Fun;    
    private TextDocument TD;
    
    int Teste = 0;

    /** Creates new form Agenda */
    public CadastroAgenda() {
        initComponents();
        Limpar();        
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jScrollPane1 = new javax.swing.JScrollPane();
        jtpObs = new javax.swing.JTextPane();
        jtfTelefone = new javax.swing.JFormattedTextField();
        jlbNumero = new javax.swing.JLabel();
        jlbCidade = new javax.swing.JLabel();
        jlbEmail = new javax.swing.JLabel();
        jdcDataNasc = new com.toedter.calendar.JDateChooser();
        jtfNomeCidade = new javax.swing.JTextField();
        jlbEndereco = new javax.swing.JLabel();
        jlbDataNasc = new javax.swing.JLabel();
        jlbCelular = new javax.swing.JLabel();
        jlbCodigo = new javax.swing.JLabel();
        jlbTelefone = new javax.swing.JLabel();
        jtfApelido = new javax.swing.JTextField();
        jlbCep = new javax.swing.JLabel();
        jtfCidade = new javax.swing.JTextField();
        jtfEmail = new javax.swing.JTextField();
        jlbNome = new javax.swing.JLabel();
        jtfCep = new javax.swing.JFormattedTextField();
        jtfCelular = new javax.swing.JFormattedTextField();
        jtfCodigo = new javax.swing.JTextField();
        jlbRgIe = new javax.swing.JLabel();
        jtfCpfCnpj = new javax.swing.JFormattedTextField();
        jlbCpfCnpj = new javax.swing.JLabel();
        jtfNome = new javax.swing.JTextField();
        jtfRgIe = new javax.swing.JFormattedTextField();
        jlbObs = new javax.swing.JLabel();
        jtfNumero = new javax.swing.JTextField();
        jtfEndereco = new javax.swing.JTextField();
        jlbApelido = new javax.swing.JLabel();
        jlbBairro = new javax.swing.JLabel();
        jtfBairro = new javax.swing.JTextField();
        jlbTipoPessoa = new javax.swing.JLabel();
        jcbTipoPessoa = new javax.swing.JComboBox();
        jtfCelular1 = new javax.swing.JFormattedTextField();
        jlbCelular1 = new javax.swing.JLabel();
        jtfTelefone1 = new javax.swing.JFormattedTextField();
        jlbTelefone1 = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        chkCliente = new javax.swing.JCheckBox();
        chkFornecedor = new javax.swing.JCheckBox();
        chkFuncionario = new javax.swing.JCheckBox();
        chkBloqueio = new javax.swing.JCheckBox();
        jlbInfoBloqueio = new javax.swing.JLabel();
        jlbOpcao = new javax.swing.JLabel();
        jbtPesquisar = new javax.swing.JButton();
        jbtExcluir = new javax.swing.JButton();
        jbtSalvar = new javax.swing.JButton();
        jbtNovo = new javax.swing.JButton();

        setClosable(true);
        setTitle("Agenda");

        jScrollPane1.setViewportView(jtpObs);

        jtfTelefone.setFormatterFactory(Fun.setFormatoTelefone());

        jlbNumero.setText("Número");

        jlbCidade.setText("Cidade (F12)");

        jlbEmail.setText("E-mail");

        jtfNomeCidade.setDisabledTextColor(new java.awt.Color(0, 0, 0));
        jtfNomeCidade.setEnabled(false);

        jlbEndereco.setText("Endereço");

        jlbDataNasc.setText("Data de Nascimento");

        jlbCelular.setText("Celular");

        jlbCodigo.setText("Código");

        jlbTelefone.setText("Telefone");

        jtfApelido.setDocument(TD = new TextDocument(50));

        jlbCep.setText("CEP");

        jtfCidade.setDocument(TD = new TextDocument(5));
        jtfCidade.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                jtfCidadeFocusLost(evt);
            }
        });
        jtfCidade.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jtfCidadeKeyPressed(evt);
            }
        });

        jtfEmail.setDocument(TD = new TextDocument(100));

        jlbNome.setText("Nome");

        jtfCep.setFormatterFactory(Fun.setFormatoCep());

        jtfCelular.setFormatterFactory(Fun.setFormatoTelefone());

        jtfCodigo.setEditable(false);
        jtfCodigo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jtfCodigoKeyPressed(evt);
            }
        });

        jlbRgIe.setText("RG / IE");

        jlbCpfCnpj.setText("CPF / CNPJ");

        jtfNome.setDocument(TD = new TextDocument(50));

        jlbObs.setText("OBS");

        jtfEndereco.setDocument(TD = new TextDocument(50));

        jlbApelido.setText("Apelido");

        jlbBairro.setText("Bairro");

        jtfBairro.setDocument(TD = new TextDocument(30));

        jlbTipoPessoa.setText("Tipo Pessoa");

        jcbTipoPessoa.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        jtfCelular1.setFormatterFactory(Fun.setFormatoTelefone());

        jlbCelular1.setText("Celular");

        jtfTelefone1.setFormatterFactory(Fun.setFormatoTelefone());

        jlbTelefone1.setText("Telefone");

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder("Opções do Cadastro"));
        jPanel1.setName(""); // NOI18N

        chkCliente.setText("Cliente");

        chkFornecedor.setText("Fornecedor");

        chkFuncionario.setText("Funcionário");

        chkBloqueio.setText("Bloqueado");

        jlbInfoBloqueio.setText("Deseja bloquear este cliente?");

        jlbOpcao.setText("Selecione a opção");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(chkFornecedor)
                    .addComponent(chkFuncionario)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(chkCliente)
                            .addComponent(jlbOpcao))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jlbInfoBloqueio)
                            .addComponent(chkBloqueio))))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jlbOpcao)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(chkCliente))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(jlbInfoBloqueio)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(chkBloqueio)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkFornecedor)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(chkFuncionario)
                .addContainerGap(22, Short.MAX_VALUE))
        );

        jbtPesquisar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Pesquisa.png"))); // NOI18N
        jbtPesquisar.setText("Pesquisar");
        jbtPesquisar.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jbtPesquisar.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        jbtPesquisar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtPesquisarActionPerformed(evt);
            }
        });

        jbtExcluir.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Excluir.png"))); // NOI18N
        jbtExcluir.setText("Excluir");
        jbtExcluir.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jbtExcluir.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        jbtExcluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtExcluirActionPerformed(evt);
            }
        });

        jbtSalvar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Salvar.png"))); // NOI18N
        jbtSalvar.setText("Salvar");
        jbtSalvar.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jbtSalvar.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        jbtSalvar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtSalvarActionPerformed(evt);
            }
        });

        jbtNovo.setIcon(new javax.swing.ImageIcon(getClass().getResource("/image/Novo.png"))); // NOI18N
        jbtNovo.setText("Novo");
        jbtNovo.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        jbtNovo.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        jbtNovo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jbtNovoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jlbEmail)
                            .addComponent(jlbObs)
                            .addComponent(jlbEndereco))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(jlbTelefone)
                                    .addComponent(jtfTelefone, javax.swing.GroupLayout.PREFERRED_SIZE, 141, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jlbCep)
                                    .addComponent(jlbCelular)
                                    .addComponent(jtfCelular, javax.swing.GroupLayout.PREFERRED_SIZE, 141, javax.swing.GroupLayout.PREFERRED_SIZE)
                                    .addComponent(jtfCep, javax.swing.GroupLayout.PREFERRED_SIZE, 141, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                        .addComponent(jlbTelefone1)
                                        .addComponent(jtfTelefone1)
                                        .addComponent(jlbDataNasc)
                                        .addComponent(jdcDataNasc, javax.swing.GroupLayout.PREFERRED_SIZE, 141, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addComponent(jlbCelular1)
                                    .addComponent(jtfCelular1, javax.swing.GroupLayout.PREFERRED_SIZE, 141, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(layout.createSequentialGroup()
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jtfBairro, javax.swing.GroupLayout.PREFERRED_SIZE, 250, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(jlbBairro))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jlbCidade)
                                            .addGroup(layout.createSequentialGroup()
                                                .addComponent(jtfCidade, javax.swing.GroupLayout.PREFERRED_SIZE, 52, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                .addComponent(jtfNomeCidade, javax.swing.GroupLayout.PREFERRED_SIZE, 283, javax.swing.GroupLayout.PREFERRED_SIZE))))
                                    .addGroup(layout.createSequentialGroup()
                                        .addComponent(jtfEndereco, javax.swing.GroupLayout.PREFERRED_SIZE, 531, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jlbNumero)
                                            .addComponent(jtfNumero, javax.swing.GroupLayout.PREFERRED_SIZE, 60, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGroup(layout.createSequentialGroup()
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jlbRgIe)
                                            .addComponent(jtfRgIe, javax.swing.GroupLayout.PREFERRED_SIZE, 289, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(jlbCpfCnpj)
                                            .addComponent(jtfCpfCnpj, javax.swing.GroupLayout.PREFERRED_SIZE, 300, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                        .addComponent(jScrollPane1, javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(jlbApelido, javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(layout.createSequentialGroup()
                                                    .addComponent(jtfCodigo, javax.swing.GroupLayout.PREFERRED_SIZE, 70, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                    .addGap(10, 10, 10))
                                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                                    .addComponent(jlbCodigo)
                                                    .addGap(47, 47, 47)))
                                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(jlbNome)
                                                .addComponent(jtfNome, javax.swing.GroupLayout.PREFERRED_SIZE, 517, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                        .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                                            .addComponent(jtfApelido, javax.swing.GroupLayout.PREFERRED_SIZE, 289, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                            .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(jlbTipoPessoa)
                                                .addComponent(jcbTipoPessoa, javax.swing.GroupLayout.PREFERRED_SIZE, 300, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                        .addComponent(jtfEmail, javax.swing.GroupLayout.Alignment.LEADING)))
                                .addGap(0, 0, Short.MAX_VALUE)))
                        .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jbtNovo, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(5, 5, 5)
                .addComponent(jbtSalvar, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(5, 5, 5)
                .addComponent(jbtExcluir, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(5, 5, 5)
                .addComponent(jbtPesquisar, javax.swing.GroupLayout.PREFERRED_SIZE, 105, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jlbCodigo)
                    .addComponent(jlbNome))
                .addGap(5, 5, 5)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(jtfCodigo, javax.swing.GroupLayout.DEFAULT_SIZE, 24, Short.MAX_VALUE)
                    .addComponent(jtfNome))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jlbApelido)
                    .addComponent(jlbTipoPessoa))
                .addGap(5, 5, 5)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jtfApelido, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jcbTipoPessoa, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jlbNumero)
                        .addGap(5, 5, 5)
                        .addComponent(jtfNumero, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jtfRgIe, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(jlbCpfCnpj)
                                    .addComponent(jlbRgIe))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jtfCpfCnpj, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(5, 5, 5)
                        .addComponent(jlbEndereco)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jtfEndereco, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jlbBairro)
                    .addComponent(jlbCidade))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jtfCidade, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jtfNomeCidade, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jtfBairro, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jlbCep)
                        .addGap(5, 5, 5)
                        .addComponent(jtfCep, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jlbTelefone)
                        .addGap(5, 5, 5)
                        .addComponent(jtfTelefone, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jlbCelular)
                        .addGap(5, 5, 5)
                        .addComponent(jtfCelular, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(jlbDataNasc)
                                .addGap(5, 5, 5)
                                .addComponent(jdcDataNasc, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jlbTelefone1)
                                .addGap(5, 5, 5)
                                .addComponent(jtfTelefone1, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jlbCelular1)
                                .addGap(5, 5, 5)
                                .addComponent(jtfCelular1, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addGap(7, 7, 7)))
                .addComponent(jlbEmail)
                .addGap(5, 5, 5)
                .addComponent(jtfEmail, javax.swing.GroupLayout.PREFERRED_SIZE, 24, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jlbObs)
                .addGap(5, 5, 5)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 58, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jbtNovo, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jbtSalvar, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jbtExcluir, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jbtPesquisar, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jtfCidadeKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jtfCidadeKeyPressed
        
        if(evt.getKeyCode() == KeyEvent.VK_ENTER){
           
            jtfNomeCidade.setText(NomeCidade(Integer.parseInt(jtfCidade.getText())));
            
            jtfCep.requestFocus();

        }
        
        if(evt.getKeyCode() == KeyEvent.VK_F12){
        
            SubPesquisaCidade A = new SubPesquisaCidade();
            A.setVisible(true);
            JDesktopPane JDP = this.getDesktopPane();
            JDP.add(A);
            A.centralizar(JDP);
            try{
                A.setSelected(true);
                A.SetSubCidade(this);
                A.Validador("Agenda");
            }catch (Exception E){
                JOptionPane.showMessageDialog(null, "Erro: " + E);
            }
            A.setVisible(true);
            
        }
        
    }//GEN-LAST:event_jtfCidadeKeyPressed

    private void jtfCodigoKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jtfCodigoKeyPressed
        if(evt.getKeyCode() == KeyEvent.VK_ENTER){

            CarregarDados(jtfCodigo.getText());

        }
    }//GEN-LAST:event_jtfCodigoKeyPressed

    private void jbtSalvarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtSalvarActionPerformed

       if (jtfCodigo.getText().equals("")){
            Fun = new Funcoes();
            jtfCodigo.setText(Fun.Proximo("codigo", "t_pessoa", ""));
        }

        Conexao = new ConexaoPostgresql();
        Conexao.Conectar();
        Conexao.setSQL("select * from t_pessoa where codigo = " + jtfCodigo.getText() + " and exclusao = 0");
        ResultSet RS = Conexao.Consultar();
        
        String myDate = null;
                
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");  
        myDate = sdf.format(jdcDataNasc.getDate());   
        System.out.println(myDate);
        
        char Cliente, Fornecedor, Funcionario, Bloqueio;
        int tipo_pessoa = ((Combo)jcbTipoPessoa.getSelectedItem()).getKey();;
        
        if (chkCliente.isSelected()) {
            Cliente = '1';
        } else {
            Cliente = '0';
        }
        
        if (chkFornecedor.isSelected()) {
            Fornecedor = '1';
        } else {
            Fornecedor = '0';
        }
        
        if (chkFuncionario.isSelected()) {
            Funcionario = '1';
        } else {
            Funcionario = '0';
        }
        
        if (chkBloqueio.isSelected()) {
            Bloqueio = '1';
        } else {
            Bloqueio = '0';
        }
        
        try {
            if(RS.next()){
                String SQL;

                SQL = "update t_pessoa set nome = '" + jtfNome.getText() + "', apelidofantasia = '" + jtfApelido.getText() + "', ";
                SQL = SQL + "tipo_pessoa = " + tipo_pessoa + ", ";
                SQL = SQL + "endereco = '" + jtfEndereco.getText() + "', numero = '" +jtfNumero.getText() + "', ";
                SQL = SQL + "bairro = '" + jtfBairro.getText() + "', cidade_cod = " + jtfCidade.getText() + ", ";
                SQL = SQL + "cep = '" + jtfCep.getText() + "', fone1 = '" + jtfTelefone.getText() + "', ";
                SQL = SQL + "fone2 = '" + jtfTelefone1.getText() + "', cel1 = '" + jtfCelular.getText() + "', ";
                SQL = SQL + "cel2 = '" + jtfCelular1.getText() + "', email = '" + jtfEmail.getText() + "', obs = '" + jtpObs.getText() + "', ";
                SQL = SQL + "chkcliente = " + Cliente + ", chkfornecedor = " + Fornecedor + ", chkfuncionario = " + Funcionario + ", ";
                SQL = SQL + "bloqueio = " + Bloqueio + " ";
                SQL = SQL + "where codigo = " + jtfCodigo.getText() + " ";

                Conexao.setSQL(SQL);
                Conexao.Executar();
            } else {
                String SQL;

                SQL = "insert into t_pessoa (codigo, nome, apelidofantasia, tipo_pessoa, rgie, cpfcnpj, endereco, numero, bairro, cep, dtnasc, cidade_cod, fone1, ";
                SQL = SQL + "fone2, cel1, cel2, email, obs, chkcliente, chkfornecedor, chkfuncionario, bloqueio, exclusao) ";
                SQL = SQL + "values (" + jtfCodigo.getText() + ", '" + jtfNome.getText() + "', '" + jtfApelido.getText() + "', ";
                SQL = SQL + tipo_pessoa + ", '" + jtfRgIe.getText() + "', '" + jtfCpfCnpj.getText() + "', '" +  jtfEndereco.getText() + "', '" ;                
                SQL = SQL + jtfNumero.getText() + "', '" + jtfBairro.getText() + "', '" + jtfCep.getText() + "', '" + myDate + "', " ;                
                SQL = SQL + jtfCidade.getText()  + ", '" + jtfTelefone.getText() + "', '" + jtfTelefone1.getText() + "', '";                
                SQL = SQL + jtfCelular.getText() + "', '" + jtfCelular1.getText() + "', '" + jtfEmail.getText() + "', '";                
                SQL = SQL + jtpObs.getText() + "', " + Cliente + ", " + Fornecedor + ", " + Funcionario + ", " + Bloqueio + ", 0)";

                Conexao.setSQL(SQL);
                Conexao.Executar();
            }

        } catch (Exception Erro) {
            JOptionPane.showMessageDialog(null, "Erro na validação: " + Erro);
        }

        Conexao.Desconectar();

        Limpar();

        jtfCodigo.requestFocus();
       
    }//GEN-LAST:event_jbtSalvarActionPerformed

    private void jbtNovoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtNovoActionPerformed

        Limpar();

        jtfNome.requestFocus();

    }//GEN-LAST:event_jbtNovoActionPerformed

    private void jbtPesquisarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtPesquisarActionPerformed
        
        PesquisaAgenda A = new PesquisaAgenda();
        A.setVisible(true);
        JDesktopPane JDP = this.getDesktopPane();
        JDP.add(A);
        A.centralizar(JDP);
        try{
            A.setSelected(true);
            A.SetCidade(this);
            A.Validador("Agenda");
        }catch (Exception E){
            JOptionPane.showMessageDialog(null, "Erro: " + E);
        }
        A.setVisible(true);
        
    }//GEN-LAST:event_jbtPesquisarActionPerformed

    private void jbtExcluirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtExcluirActionPerformed
        
        if (!(jtfCodigo.getText().trim().equals(""))) {
        
            Object[] botoes = { "Sim", "Não" };

            int resposta;

            resposta = JOptionPane.showOptionDialog(null, "Você deseja realmente excluir este registro?", "Confirma exclusão", JOptionPane.YES_NO_OPTION,JOptionPane.QUESTION_MESSAGE, null, botoes, botoes[0]);

            if(resposta == JOptionPane.YES_OPTION){

                String SQL = "update t_pessoa set exclusao = 1 where codigo = " + jtfCodigo.getText() + " ";

                Conexao = new ConexaoPostgresql();
                Conexao.Conectar();
                Conexao.setSQL(SQL);
                Conexao.Executar();
                Conexao.Desconectar();

                Limpar();

            }

            jtfNome.requestFocus();
            
        }
        
    }//GEN-LAST:event_jbtExcluirActionPerformed

    private void jtfCidadeFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jtfCidadeFocusLost
        
        if (!(jtfCidade.getText().trim().equals(""))) {
        
            jtfNomeCidade.setText(NomeCidade(Integer.parseInt(jtfCidade.getText())));
            
            jtfCep.requestFocus();
        
        }
        
    }//GEN-LAST:event_jtfCidadeFocusLost


    private void Limpar(){

        jtfCodigo.setText("");
        jtfNome.setText("");
        jtfApelido.setText("");
        jcbTipoPessoa.removeAllItems();
        JogarTipoPessoa();
        jtfRgIe.setText("");
        jtfCpfCnpj.setText("");
        jtfEndereco.setText("");
        jtfNumero.setText("");
        jtfBairro.setText("");
        jtfCidade.setText("");
        jtfNomeCidade.setText("");
        jtfCep.setText("");
        jtfTelefone.setText("");
        jtfTelefone1.setText("");
        jtfCelular.setText("");
        jtfCelular1.setText("");
        jdcDataNasc.setDate(new java.util.Date());
        jtfEmail.setText("");
        jtpObs.setText("");        
        chkCliente.setSelected(false);
        chkFornecedor.setSelected(false);
        chkFuncionario.setSelected(false);
        chkBloqueio.setSelected(false);        
        
    }

    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new CadastroAgenda().setVisible(true);
            }
        });
    }

    public void centralizar(JDesktopPane dp) {
        Dimension ds = dp.getSize();
        Dimension dw = this.getSize();
        this.setLocation((ds.width - dw.width) / 2, (ds.height - dw.height) / 2);
    }

    public void CarregarDados(String Codigo){

        String SQL;

        SQL = "select tag.*, to_char(tag.dtnasc,'DD/MM/YYYY') as data, (ttp.nome) as str_tipo_pessoa ";
        SQL = SQL + "from t_pessoa tag ";
        SQL = SQL + "inner join t_pessoa_tipo ttp on ttp.codigo = tag.tipo_pessoa ";
        SQL = SQL + "where tag.codigo = '" + Codigo + "' "; //postgresql                
//        SQL = "select tag.* from t_agenda tag where tag.codigo = '" + Codigo + "'"; //mysql
        SQL = SQL + "and tag.exclusao = 0 ";
        
        Conexao = new ConexaoPostgresql();
        Conexao.Conectar() ;
        Conexao.setSQL(SQL);

        ResultSet RS = Conexao.Consultar();

        try{
            if (RS.next()){
                jtfCodigo.setText(RS.getString("codigo"));
                jtfNome.setText(RS.getString("nome"));
                jtfApelido.setText(RS.getString("apelidofantasia"));
                
                Combo TipoPessoa = new Combo(Integer.parseInt(RS.getString("tipo_pessoa")), RS.getString("str_tipo_pessoa"));
                ComboBoxModel CBM1;
                CBM1 = jcbTipoPessoa.getModel();
                CBM1.setSelectedItem(TipoPessoa);
                
                jtfRgIe.setText(RS.getString("rgie"));
                jtfCpfCnpj.setText(RS.getString("cpfcnpj"));
                jtfEndereco.setText(RS.getString("endereco"));
                jtfNumero.setText(RS.getString("numero"));
                jtfBairro.setText(RS.getString("bairro"));
                jtfCidade.setText(RS.getString("cidade_cod"));
                jtfNomeCidade.setText(NomeCidade(Integer.parseInt(RS.getString("cidade_cod"))));
                jtfCep.setText(RS.getString("cep"));
                jtfTelefone.setText(RS.getString("fone1"));
                jtfTelefone1.setText(RS.getString("fone2"));
                jtfCelular.setText(RS.getString("cel1")); 
                jtfCelular1.setText(RS.getString("cel2"));
                jdcDataNasc.setDate(RS.getDate("dtnasc"));
                jtfEmail.setText(RS.getString("email"));
                
                if (RS.getString("chkcliente").equals("1")) {
                    chkCliente.setSelected(true);
                }
                
                if (RS.getString("chkfornecedor").equals("1")) {
                    chkFornecedor.setSelected(true);
                }
                
                if (RS.getString("chkfuncionario").equals("1")) {
                    chkFuncionario.setSelected(true);
                }
                
                if (RS.getString("bloqueio").equals("1")) {
                    chkBloqueio.setSelected(true);
                }
                
                jtpObs.setText(RS.getString("obs"));
            }
        }catch (Exception Erro){
            JOptionPane.showMessageDialog(null, "Erro na validação: " + Erro);
        }

        Conexao.Desconectar();

        jtfNome.requestFocus();

    }

    public String NomeCidade (int CodigoCidade){
        
        String Cidade = null;
        
        Fun = new Funcoes();
        Cidade = Fun.NomeCidade(CodigoCidade);
        Cidade = Cidade + " - " + Fun.SiglaEstado(CodigoCidade);
        
        return Cidade;
        
    }
    
    public void NomeCidadeViaF12 (int CodigoCidade){
        
        jtfCidade.setText(String.valueOf(CodigoCidade));
        jtfNomeCidade.setText(NomeCidade(CodigoCidade));
        
    }
    
    private void JogarTipoPessoa(){

        jcbTipoPessoa.removeAllItems();
        try {
            Conexao = new ConexaoPostgresql();
            Conexao.Conectar();
            Conexao.setSQL("select codigo, nome from t_pessoa_tipo where exclusao = 0 order by nome");
            ResultSet RS = Conexao.Consultar();
            DefaultComboBoxModel Modelo = new DefaultComboBoxModel();
            while(RS.next()){
                Combo cboF = new Combo(Integer.parseInt(RS.getString("codigo")),RS.getString("nome"));
                Modelo.addElement(cboF);
            }
            jcbTipoPessoa.setModel(Modelo);
        } catch(Exception Erro){
            JOptionPane.showMessageDialog(null, "Erro: " + Erro);
        }

    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JCheckBox chkBloqueio;
    private javax.swing.JCheckBox chkCliente;
    private javax.swing.JCheckBox chkFornecedor;
    private javax.swing.JCheckBox chkFuncionario;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JButton jbtExcluir;
    private javax.swing.JButton jbtNovo;
    private javax.swing.JButton jbtPesquisar;
    private javax.swing.JButton jbtSalvar;
    private javax.swing.JComboBox jcbTipoPessoa;
    private com.toedter.calendar.JDateChooser jdcDataNasc;
    private javax.swing.JLabel jlbApelido;
    private javax.swing.JLabel jlbBairro;
    private javax.swing.JLabel jlbCelular;
    private javax.swing.JLabel jlbCelular1;
    private javax.swing.JLabel jlbCep;
    private javax.swing.JLabel jlbCidade;
    private javax.swing.JLabel jlbCodigo;
    private javax.swing.JLabel jlbCpfCnpj;
    private javax.swing.JLabel jlbDataNasc;
    private javax.swing.JLabel jlbEmail;
    private javax.swing.JLabel jlbEndereco;
    private javax.swing.JLabel jlbInfoBloqueio;
    private javax.swing.JLabel jlbNome;
    private javax.swing.JLabel jlbNumero;
    private javax.swing.JLabel jlbObs;
    private javax.swing.JLabel jlbOpcao;
    private javax.swing.JLabel jlbRgIe;
    private javax.swing.JLabel jlbTelefone;
    private javax.swing.JLabel jlbTelefone1;
    private javax.swing.JLabel jlbTipoPessoa;
    private javax.swing.JTextField jtfApelido;
    private javax.swing.JTextField jtfBairro;
    private javax.swing.JFormattedTextField jtfCelular;
    private javax.swing.JFormattedTextField jtfCelular1;
    private javax.swing.JFormattedTextField jtfCep;
    private javax.swing.JTextField jtfCidade;
    private javax.swing.JTextField jtfCodigo;
    private javax.swing.JFormattedTextField jtfCpfCnpj;
    private javax.swing.JTextField jtfEmail;
    private javax.swing.JTextField jtfEndereco;
    private javax.swing.JTextField jtfNome;
    private javax.swing.JTextField jtfNomeCidade;
    private javax.swing.JTextField jtfNumero;
    private javax.swing.JFormattedTextField jtfRgIe;
    private javax.swing.JFormattedTextField jtfTelefone;
    private javax.swing.JFormattedTextField jtfTelefone1;
    private javax.swing.JTextPane jtpObs;
    // End of variables declaration//GEN-END:variables

}
